{% extends "base.html" %} {% load staticfiles %} {% block title %} Home {% endblock title %} {% block content %}
<div class="row" style="margin-top:-20px">
  <div class="large-12 columns">
    <div class="row">
      <div class="large-12 columns">
        <div class="box palette-Grey-300 bg">
          <div class="box-header  palette-Grey-300 bg">
            <h3 class="box-title"><span class="text-white">&nbsp;&nbsp;&nbsp;NEW JOB</span></h3>
            <div class="pull-right text-white box-tools">
              <span class="text-white box-btn"><i class="circle-nest-medium ti-notepad"></i>
              </span> &nbsp;&nbsp;&nbsp;
            </div>
            <div class="medium-9 columns ">
              <div>


                <script>
                  function report(value) {
                    if (value=="") return; // please select - possibly you want something else here
                    else{
                      $.get("{%url "app:divisionFromBrand" %}", { "brand": value},
                          function(divisions){
                              //  console.log(divisions, divisions["divisions"].length);
                               $('#mySelect option').remove();
                               for(var count=0; count < divisions["divisions"].length; count++){
                                //  console.log("values",divisions["divisions"][count]["id"] );
                                $('#mySelect').append( new Option(divisions["divisions"][count]["name"],divisions["divisions"][count]["id"]) );
                               }
                              //  $('#mySelect').append( new Option(text,val) );
                      }).fail(function(){
                          console.log("error");
                      });
                    }
                  }
                </script>

                <form action="#" method="POST" class="form-inline">{% csrf_token %}
                  <br>
                  <br>
                  <h4 style="color: red">{{message}}</h4>

                  <div class="form-group">

                    <label  >Brand Name:</label>
                    <select name="brand" class="form-control" onchange="report(this.value)">
                      {%for each in brands %}
                        <option value={{each.pk}}>{{each.name}}</option>
                      {% endfor %}
                    </select>
                  </div>



                  <div class="form-group">
                    <label  name="brand">Division Name:</label>
                    <select id="mySelect" multiple class="form-control" required>

                    </select>
                  </div>

                  <div class="form-group">
                    <label >Job Name:</label>
                    <input type="text" class="form-control" name="jobsName" required>
                  </div>


                  <div class="form-group">
                    <table class="table table-striped">
                      <thead>
                        <tr>
                          <th>Color List</th>
                          <th>Brand Color</th>
                          <th>Patch Tolerance</th>
                          <th>
                            <button type="button" class="btn btn-default" onclick="fieldAdd();"><span>Add</span></button>
                            <button type="button" class="btn btn-default" onclick="fieldRemove();"><span>Remove</span></button>
                          </th>

                        </tr>
                      </thead>
                      <script>
                        var count=1;
                      </script>
                      <script>
                        function fieldAdd() {
                          count+=1;
                          $('#addTable').append(
                            "<tr><td><input type='text' class='form-control' name='colorList"+count+"'></td><td><input type='text' class='form-control' name='brandColor"+count+"'></td><td><input type='text' class='form-control' name='patchTolerance"+count+"'></td><td></tr>"
                          )
                        }
                      </script>
                      <script>
                      function fieldRemove() {
                        count-=1;
                        console.log("here");
                        $('#addTable tr').last().remove()
                        return false;
                      }

                      </script>

                      <tbody id="addTable">
                        <tr>
                          <td><input type="text" class="form-control" name="colorList1" required></td>
                          <td><input type="text" class="form-control" name="brandColor1" required></td>
                          <td><input type="text" class="form-control" name="patchTolerance1" required></td>
                          <td></td>
                        </tr>

                      </tbody>
                    </table>

                    <label  >Active:</label>
                    <select name="active" class="form-control" required>
                          <option value="True">Active</option>
                          <option value="False">Inactive</option>
                    </select>
                  </div>



                  <button type="submit" class="btn btn-default">Create Job</button>

                  <br>
                  <br>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

{% endblock content %}
